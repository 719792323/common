# 性能测试分类

### 性能测试

性能测试方法是通过测试工具模拟用户请求系统，目的主要是为了**测试系统的性能是否满足要求**。通俗地说，这种方法就是要在特定的运行条件下验证系统的能力状态。性能测试是你在对系统性能已经有了解的前提之后进行的，并且**有明确的性能指标**。

### 负载测试

**对被测试的系统继续加大请求压力，直到服务器的某个资源已经达到饱和了**，比如系统的缓存已经不够用了或者系统的响应时间已经不满足要求了。负载测试说白点就是**测试系统的上限**。

### 压力测试

**不去管系统资源的使用情况，对系统继续加大请求压力**，**直到服务器崩溃无法再继续提供服务的测试**。

### 稳定性测试

**模拟真实场景**，给系统一定压力，看看业务是否能**稳定运行**



# 测试/监控目标

### 测试/监控指标有哪些？

[阿里指标归纳](https://help.aliyun.com/zh/pts/test-metrics?spm=a2c4g.11186623.0.0.4c2229ceHnvUyB)

#### 业务性能指标

* 响应时间**RT**：响应时间，指的是业务从客户端发起到客户端接收的时间
* 系统处理能力
  - HPS（Hits Per Second） ：每秒点击次数，单位是次/秒。
  - **TPS**（Transaction per Second）：系统每秒处理交易数，单位是笔/秒。
  - QPS（Query per Second）：系统每秒处理查询次数，单位是次/秒。 对于互联网业务中，**如果某些业务有且仅有一个请求连接，那么TPS=QPS=HPS**，一般情况下用TPS来衡量整个业务流程，用QPS来衡量接口查询次数，用HPS来表示对服务器单击请求。
  - RPS：Request Per Second，每秒请求数。RPS模式适合用于容量规划和作为限流管控的参考依据
* 并发用户：并发用户数指在同一时刻内，登录系统并进行业务操作的用户数量
* 错误率: 错误率指系统在负载情况下，失败交易的概率。错误率＝（失败交易数/交易总数）×100%。稳定性较好的系统，其错误率应该由超时引起，即为超时率

#### 资源指标

* CPU：**CPU使用率**、利用率要低于业界警戒值范围之内，即小于或者等于75%、CPU sys%小于或者等于30%，CPU wait%小于或者等于5%
* 内存：现代的操作系统为了最大利用内存，在内存中存放了缓存，因此内存利用率100%并不代表内存有瓶颈，衡量系统内有瓶颈主要靠SWAP（与虚拟内存交换）交换空间利用率，一般情况下，**SWAP交换空间利用率要低于70%**，太多的交换将会引起系统性能低下
* 磁盘：磁盘指标主要有每秒读写多少兆，磁盘繁忙率，磁盘队列数，平均服务时间，平均等待时间，空间利用率。其中磁盘繁忙率是直接反映磁盘是否有瓶颈的重要依据，一般情况下，**磁盘繁忙率**要低于70%
* 网络：网络吞吐量指标主要有每秒有多少兆流量进出，一般情况下不能超过设备或链路**最大传输能力（网络占用率）**的70%
* 操作系统内核：主要包括**信号量、进程、文件句柄**

#### 应用指标

* Java

  * **JVM**

    * GC频率

    * Full GC频率

    * Full GC平均时长

    * 堆使用率

    注：GC频率不能频繁，特别是FULL GC更不能频繁，一般情况下系统性能较好的情况下，JVM最小堆大小和最大堆大小分别设置1024 M比较合适

  * **线程池**

    * Active Thread Count：活跃线程数
    * Pending User Request：处于排队的用户请求个数

    注：当前正在运行的线程数不能超过设定的最大值。一般情况下系统性能较好的情况下，线程数最小值设置50和最大值设置200比较合适

  * **JDBC**

    * JDBC Active Connection：JDBC活动连接数

    注：当前运行的JDBC连接数不能超过设定的最大值。一般情况下系统性能较好的情况下，JDBC最小值设置50和最大值设置200比较合适

  * Tomcat

* 数据库

  * SQL

    * SQL耗时

    注：SQL耗时越小越好，一般情况下微秒级别

  * 吞吐量

    * QPS：每秒查询次数
    * TPS：每秒事务次数

  * 命中率

    | Key Buffer命中率    | 百分之 | 索引缓冲区命中率   |
    | ------------------- | ------ | ------------------ |
    | InnoDB Buffer命中率 | 百分之 | InnoDB缓冲区命中率 |
    | Query Cache命中率   | 百分之 | 查询缓存命中率     |
    | Table Cache命中率   | 百分之 | 表缓存命中率       |
    | Thread Cache命中率  | 百分之 | 线程缓存命中率     |

    注：命中率越高越好，一般情况下不能低于95%

  * 锁

    * 锁等待次数
    * 锁等待时间

    注：锁等待次数越低越好，等待时间越短越好

* 消息队列

  

* 缓存

  

* nginx

  

#### 可扩展指标

* 扩展性能：（增加性能/原始性能）/（增加资源/原始资源）×100%

  注：理想的扩展能力是资源增加几倍，性能就提升几倍、扩展能力至少在70%以上

#### 稳定性指标

- 性能稳定：各性能指标监控曲线没有大幅度的波动。
- 资源稳定：各项资源指标没有泄露或异常情况。